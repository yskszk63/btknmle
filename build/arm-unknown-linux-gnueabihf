#!/bin/bash
set -eu

image=arm-unknown-linux-gnueabihf

docker run --rm --privileged multiarch/qemu-user-static --reset -p yes
docker build -t $image << EOF
FROM yskszk63/archlinuxarm-rpi-rustbuild
RUN pacman -Syy systemd-libs libinput pkgconf --noconfirm
EOF

docker run --rm -v build:/build -v cargo:/opt/cargo -u $(id -u):$(id -g) $image
ls -l target/arm-unknown-linux-gnueabihf/release
